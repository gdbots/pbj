<schema-mapping xmlns="gdbots:pbjc:schema-mapping"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <entity id="pbj:gdbots:pbj:mixin:entity:1-0-0" mixin="true">
    <fields>
      <field name="_id" type="identifier" required="true" overridable="true">
        <php_options>
          <class_name>Gdbots\Identifiers\UuidIdentifier</class_name>
          <default>
            <![CDATA[
                  function() {
                      return UuidIdentifier::generate();
                  }
            ]]>
          </default>
        </php_options>
      </field>

      <field name="etag" type="string" pattern="^[A-Za-z0-9_\-]+$"/>
      <field name="created_at" type="microtime" />
      <field name="updated_at" type="microtime" />
    </fields>

    <php_options>
      <namespace>Gdbots\Schemas\Pbj\Entity</namespace>
      <trait_class>
        <use_statements>
            <![CDATA[
use Gdbots\Pbj\MessageRef;
            ]]>
        </use_statements>
        <class_body>
            <![CDATA[
    /**
     * @param string $tag
     * @return MessageRef
     */
    public function generateMessageRef($tag = null)
    {
        return new MessageRef(static::schema()->getCurie(), $this->get('_id'), $tag);
    }
            ]]>
        </class_body>
      </trait_class>
    </php_options>
  </entity>
</schema-mapping>
