<?php

namespace {{ schema.language('php').get('namespace') }};

{% block use_statements %}
use Gdbots\Pbj\AbstractMixin;
{% if schema.fields|length %}
use Gdbots\Pbj\FieldBuilder as Fb;
{% endif %}
use Gdbots\Pbj\SchemaId;
{% if schema.fields|length %}
use Gdbots\Pbj\Type as T;
{% endif %}
{% set format_class = false %}
{% for field in schema.fields %}
{% if field.format %}
{% set format_class = true %}
{% endif %}
{% if field.language('php').get('classname') %}
use {{ field.language('php').get('classname') }};
{% endif %}


{% if field.anyOf %}
{% if field.anyOf|length == 1 %}
    {{ spaces|format('') }}->className({{ getClassName(field.anyOf.0) }}::class)
{% else %}
    {{ spaces|format('') }}->anyOfClassNames([
{% for schema in field.anyOf %}
    {{ spaces|format('') }}  {{ getClassName(schema) }}::class{% if not loop.last %}, {% endif %}

{% endfor %}
    {{ spaces|format('') }}])
{% endif %}




{% endfor %}
{% if format_class %}
use Gdbots\Pbj\Enum\Format;
{% endif %}
{% endblock use_statements %}

{% block class_definition %}
final class {{ getClassName(schema, true) }}Mixin extends AbstractMixin
{% endblock class_definition %}
{
{% block class_body %}
    /**
     * {@inheritdoc}
     */
    public function getId()
    {
        return SchemaId::fromString('{{ schema.id }}');
    }

    /**
     * {@inheritdoc}
     */
    public function getFields()
    {
{% if schema.fields|length %}
        return [
{% import 'php/macros.twig' as macros %}
{% for field in schema.fields %}
          {{ macros.draw_field(field, 12, loop.last) }}
{%- endfor %}
        ];
{% else %}
        return [];
{% endif %}
    }
{% endblock class_body %}
}
